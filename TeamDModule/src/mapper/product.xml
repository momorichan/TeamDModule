<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="product">
  	<insert id="add" parameterType="pvo">
  		insert into product values(product_seq.nextval, #{pname}, #{price}, #{scnum}, #{stock}, #{pdetail}, #{image}, #{image2}, #{image3})
  	</insert>
  	<select id="lclist" resultType="lcvo">
  		select lcnum, lcname from lcategory
  	</select>
  	<select id="sclist" resultType="scvo" parameterType="int">
  		select scnum, lcnum, scname from scategory where lcnum = #{lcnum}
  	</select>
  	<select id="prlist" resultType="pvo" >
  		select pnum, pname, price, scnum ,stock,pdetail, image, image2, image3 from product
  	</select>
	<select id="totalCount" resultType="int" parameterType="map">
		select count(*) cnt from product
		<if test="searchValue != null and searchType != null">
			<where> <!-- 아래 choose문이 실행되지 않으면 자동으로 사라진다. 이게 바로 다이나믹 쿼리 -->
				<choose>
					<when test="searchType == 1">
						title like '%'||#{searchValue}||'%'
					</when>
					<when test="searchType == 2">
						writer like '%'||#{searchValue}||'%'
					</when>
					<when test="searchType == 3">
						content like '%'||#{searchValue}||'%'
					</when>
				</choose>
			</where>
		</if>
	</select>
  </mapper>