<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="product">
	<insert id="add" parameterType="pvo">
		insert into product
		values(product_seq.nextval, #{pname}, #{price},
		#{scnum}, #{stock},
		#{pdetail}, #{image}, #{image2}, #{image3})
	</insert>
	<select id="lclist" resultType="lcvo">
		select lcnum, lcname from
		lcategory
	</select>
	<select id="sclist" resultType="scvo" parameterType="int">
		select
		scnum, lcnum, scname from scategory where lcnum = #{lcnum}
	</select>
	
	
	<select id="prlist" resultType="pvo" parameterType="map">
		select pnum, pname, price, scnum,stock,pdetail, image, image2, image3
		from product
		<if test="searchValue != null">
			<where>
				pname like '%'||#{searchValue}||'%'
			</where>
		</if>
	</select>
	
	
	<select id="totalCount" resultType="int" parameterType="map">
		select count(*) cnt from product
		<if test="searchValue != null">
			<where>
				pname like '%'||#{searchValue}||'%'
			</where>
		</if>
	</select>
	
	
	<select id="SearchByCategory" parameterType="map" resultType="pvo">
		SELECT * FROM product 
		<where>
			<choose>
				<when test="lcnum != null">
					scnum IN (SELECT scnum FROM scategory WHERE lcnum = #{lcnum})
				</when>
				<when test="scnum != null">
					scnum  = #{scnum}
				</when>
			</choose>	
		</where>
	</select>
  </mapper>
